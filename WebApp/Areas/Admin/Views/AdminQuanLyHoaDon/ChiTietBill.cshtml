@using System.Globalization;
@{

    ViewBag.Title = "ChiTietBill";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
    var in4bill = ViewBag.Datain4Bill;
}

<div class="box">
    <h4>Thông tin đơn hàng</h4>
    @foreach (var item in in4bill.lst)
    {
        <table class="table">
            <tr>
                <th>
                    Trạng Thái
                </th>
                <th>
                    Người Nhận
                </th>
                <th>
                    Phí Vận Chuyển
                </th>

                <th>
                    Tiền Hàng
                </th>

                <th>
                    Tổng đơn hàng
                </th>
                <th>
                    Ghi chú đơn
                </th>
                <th>
                    Ngày đặt
                </th>

                
            </tr>
            @{ 
                DateTime date = DateTime.ParseExact(@item.DateCreate, "dd/MM/yyyy HH:mm:ss", CultureInfo.InvariantCulture);
            }
            <tr>
                <td style="color:deepskyblue">
                    @item.NameStatus
                </td>
                <td>
                    @item.NameReceiver
                    <br>
                    @item.Phone
                </td>
                <td>
                    30.000đ
                </td>

                <td>
                    @item.TotalNew
                </td>
                <td>
                    @((@item.TotalNew + 30_000).ToString("N0"))đ
                </td>
                <td>
                </td>

                <td>
                    @date.ToString("dd/MM/yyyy")

                </td>

                
            </tr>
            <tr>
                <td colspan="3" style="font-weight: bold"><i class="fa fa-map-marker"></i> Địa chỉ: @item.Address</td>
                <td colspan="3" style="font-weight: bold"> Số Điện Thoại: @item.Phone</td>
            </tr>
        </table>
        break;
    }
    </div>
<h4>Chi tiết đơn hàng:</h4>
<div class="box">
    <table class="table table-bordered">
        <tr>
            <th>Sản phẩm</th>
            <th>Đơn giá</th>
            <th>Số lượng</th>
            <th>Thành tiền</th>
        </tr>
        @{
            decimal total = 0; // Khởi tạo biến tạm với giá trị ban đầu là 0
        }

        @foreach (var d in in4bill.lst)
        {
            <tr>
                <td>@d.Product</td>
                <td>@d.Price</td>
                <td>@d.Quantity</td>
                <td>@d.Total</td>
            </tr>

            {
                total += Convert.ToDecimal(d.Total); // Chuyển đổi kiểu dữ liệu và cộng dồn giá trị Total vào biến tạm
            }
        }

        <tr>
            <th colspan="3" style="text-align:right">Tổng cộng:</th>
            <th class="nn-cart-total">@total.ToString("N0")<sup>đ</sup></th>
        </tr>



    </table>
</div>
<p>
    @Html.ActionLink("Edit", "Edit") |
    @Html.ActionLink("Back to List", "Index")
</p>


